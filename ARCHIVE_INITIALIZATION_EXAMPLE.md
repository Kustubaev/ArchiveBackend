# Пример инициализации архива

## Инициализация через API

После запуска приложения и применения миграций необходимо инициализировать архив.

### Эндпоинт

```
POST /api/archive/initialize
```

### Пример запроса с дефолтным распределением

```json
{
  "idealDistribution": {
    "А": 2.5, "Б": 1.8, "В": 2.2, "Г": 1.5,
    "Д": 2.0, "Е": 1.2, "Ё": 0.1, "Ж": 0.8,
    "З": 1.2, "И": 2.8, "Й": 0.3, "К": 3.5,
    "Л": 2.0, "М": 2.5, "Н": 2.2, "О": 1.5,
    "П": 3.0, "Р": 2.8, "С": 4.5, "Т": 2.5,
    "У": 1.0, "Ф": 0.8, "Х": 1.2, "Ц": 0.5,
    "Ч": 1.5, "Ш": 1.0, "Щ": 0.5, "Ъ": 0.0,
    "Ы": 0.3, "Ь": 0.0, "Э": 0.2, "Ю": 0.3,
    "Я": 1.5
  },
  "totalFilesForPlanning": 3000,
  "boxCapacity": 50,
  "boxReservePercent": 10
}
```

### Минимальный запрос (используются значения по умолчанию)

```json
{
  "idealDistribution": {
    "А": 2.5, "Б": 1.8, "В": 2.2, "Г": 1.5,
    "Д": 2.0, "Е": 1.2, "Ё": 0.1, "Ж": 0.8,
    "З": 1.2, "И": 2.8, "Й": 0.3, "К": 3.5,
    "Л": 2.0, "М": 2.5, "Н": 2.2, "О": 1.5,
    "П": 3.0, "Р": 2.8, "С": 4.5, "Т": 2.5,
    "У": 1.0, "Ф": 0.8, "Х": 1.2, "Ц": 0.5,
    "Ч": 1.5, "Ш": 1.0, "Щ": 0.5, "Ъ": 0.0,
    "Ы": 0.3, "Ь": 0.0, "Э": 0.2, "Ю": 0.3,
    "Я": 1.5
  }
}
```

## Проверка статуса инициализации

```
GET /api/archive/status
```

Ответ:
```json
{
  "isInitialized": true,
  "configurationExists": true,
  "lettersCount": 34,
  "boxesCount": 67,
  "filesCount": 0
}
```

## Что происходит при инициализации

1. **Создается конфигурация архива** с указанными параметрами
2. **Генерируются буквы** (А-Я, Ё) + специальная буква "-" для переполнения
3. **Рассчитываются позиции** для каждой буквы на основе идеального распределения
4. **Создаются коробки** с эффективной вместимостью (BoxCapacity * (100 - BoxReservePercent) / 100)
5. **Добавляется резерв** коробок (+10% от расчетного количества)

## Важно

- Инициализацию можно выполнить только один раз
- Для переинициализации необходимо очистить данные вручную
- Распределение букв должно быть нормализовано (сумма = 100%), но система автоматически нормализует его

## Использование через Swagger

1. Откройте Swagger UI: `https://localhost:5001/swagger`
2. Найдите эндпоинт `POST /api/archive/initialize`
3. Нажмите "Try it out"
4. Вставьте JSON с распределением
5. Нажмите "Execute"

